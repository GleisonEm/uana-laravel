(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"2b64":function(t,e,a){"use strict";a("ae6f")},"3b25":function(t,e,a){},"5b96":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.publishing?a("q-card",[a("q-card-section",[a("content-form",{attrs:{classId:t.classId},on:{success:t.onContentAdded}},[a("q-btn",{on:{click:function(e){t.publishing=!1}}},[t._v("Cancelar")])],1)],1)],1):a("q-input",{attrs:{label:t.inputLabel},on:{focus:function(e){t.publishing=!0}}}),a("br"),t._l(t.readyPosts,(function(e){return a("post",{key:e.id,attrs:{post:e},on:{reacted:function(a){return t.onReact(e,a)}}})}))],2)},o=[],n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-card",{staticClass:"mb-20"},[a("q-card-section",[a("q-carousel",{staticClass:"rounded-borders",attrs:{"transition-prev":"scale","transition-next":"scale",animated:"",navigation:"",arrows:"","control-color":"red"},model:{value:t.carouselIndex,callback:function(e){t.carouselIndex=e},expression:"carouselIndex"}},t._l(t.post.resources,(function(e,s){return a("q-carousel-slide",{key:"post-"+t.post.id+"-"+s,staticClass:"column no-wrap flex-center",attrs:{name:s}},["img"===e.type?a("img",{staticClass:"post-img",attrs:{src:e.data.url}}):t._e(),"location"===e.type?a("div",{staticClass:"small-map-container"},[a("GoogleMap",{attrs:{mapConfig:{center:e.data.coordinates[0],zoom:14},defaultMarker:{position:e.data.coordinates[0]},noInteraction:!0}})],1):t._e()])})),1),t.currentResourceDescription?a("p",[t._v("\n      "+t._s(t.currentResourceDescription)+"\n    ")]):t._e()],1),a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v(t._s(t.post.title))]),a("div",{staticClass:"text-subtitle2"},[t._v(t._s(t.post.subtitle))])]),a("q-card-section",{staticClass:"q-pt-none"},[t._v("\n    "+t._s(t.post.body)+"\n  ")]),a("q-card-actions",[a("reactions",{attrs:{selectedReaction:t.post.reactedWith},on:{reacted:t.onReact}})],1)],1)},i=[],c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{"reactions-container":!0,expanded:t.expanded}},t._l(t.reactions,(function(e,s){return a("q-btn",{directives:[{name:"touch-hold",rawName:"v-touch-hold:300.mouse",value:t.expand,expression:"expand",arg:"300",modifiers:{mouse:!0}}],key:e.name,class:{main:t.isMainReaction(e),reaction:!0,first:!t.selectedReaction&&0===s},style:t.buttonStyle(e,s),attrs:{round:"",flat:""},on:{click:function(a){return t.dispatch(e)}}},[t._v("\n    "+t._s(e.icon)+"\n  ")])})),1)},r=[],l={name:"Reactions",props:{selectedReaction:{type:String,required:!1}},data:()=>({expanded:!1,availableReactions:[{icon:"👍",name:"like"},{icon:"👏",name:"applaud"},{icon:"🤔",name:"think"}]}),computed:{reactions(){if(!this.selectedReaction)return this.availableReactions;const t=this.availableReactions[0],e=this.availableReactions.filter((t=>t.name===this.selectedReaction))[0];return e?this.availableReactions.map(((a,s)=>(e.name===a.name&&(a=t),0===s&&(a=e),a))):this.availableReactions}},methods:{dispatch(t){this.$emit("reacted",t.name),this.expanded=!1},isMainReaction(t){return!(!this.selectedReaction||this.selectedReaction!==t.name)},expand(){this.expanded=!0},buttonStyle(t,e){const a={left:40*e+"px"};return a}}},d=l,u=(a("95fe"),a("2877")),p=a("9c40"),m=a("f449"),g=a("eebe"),h=a.n(g),f=Object(u["a"])(d,c,r,!1,null,"bc967b3a",null),b=f.exports;h()(f,"components",{QBtn:p["a"]}),h()(f,"directives",{TouchHold:m["a"]});var v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"google-map-container"},[a("div",{ref:"googleMap",staticClass:"google-map"}),Boolean(this.google)&&Boolean(this.map)?[t._t("default",null,{google:t.google,map:t.map})]:t._e()],2)},C=[],q=a("c333"),y=q["a"],x=(a("a0ac"),Object(u["a"])(y,v,C,!1,null,"7c7a6fc7",null)),I=x.exports,L={components:{Reactions:b,GoogleMap:I},name:"Post",props:{post:{required:!0,type:Object}},data:()=>({carouselIndex:0}),computed:{currentResourceDescription(){return this.post.resources&&this.post.resources[this.carouselIndex]?this.post.resources[this.carouselIndex].data.description:null}},methods:{onReact(t){this.$emit("reacted",t)}}},M=L,_=(a("d3c5"),a("f09f")),k=a("a370"),w=a("880c"),R=a("62cd"),A=a("4b7e"),Q=Object(u["a"])(M,n,i,!1,null,"43d2d0de",null),O=Q.exports;h()(Q,"components",{QCard:_["a"],QCardSection:k["a"],QCarousel:w["a"],QCarouselSlide:R["a"],QCardActions:A["a"]});var $=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-form",{attrs:{loading:!0},on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-8"},[a("q-input",{attrs:{required:"",label:"Título",autofocus:""},model:{value:t.content.title,callback:function(e){t.$set(t.content,"title",e)},expression:"content.title"}})],1),a("div",{staticClass:"col-4 text-right"},[a("q-btn-dropdown",{staticClass:"mt-10",attrs:{size:"sm",color:"primary",label:"Adicionar"}},[a("q-list",[a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:t.toggleImageAttach}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{icon:"image"}})],1),a("q-item-section",[a("q-item-label",[t._v("\n              Imagem\n            ")])],1)],1),a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:t.toggleMap}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{icon:"location_on"}})],1),a("q-item-section",[a("q-item-label",[t._v("\n              Localização\n            ")])],1)],1)],1)],1)],1)]),a("q-input",{attrs:{label:"Subtítulo"},model:{value:t.content.subtitle,callback:function(e){t.$set(t.content,"subtitle",e)},expression:"content.subtitle"}}),a("q-input",{attrs:{label:"Conteúdo",type:"textarea",outlined:"",required:""},model:{value:t.content.body,callback:function(e){t.$set(t.content,"body",e)},expression:"content.body"}}),a("q-card",{directives:[{name:"show",rawName:"v-show",value:t.resources.length,expression:"resources.length"}],staticClass:"mt-10"},[a("q-card-section",[a("q-carousel",{staticClass:"rounded-borders",attrs:{"transition-prev":"slide-right","transition-next":"slide-left",animated:"",navigation:"",arrows:"","control-color":"primary"},model:{value:t.carouselLocationIndex,callback:function(e){t.carouselLocationIndex=e},expression:"carouselLocationIndex"}},t._l(t.resources,(function(e,s){return a("q-carousel-slide",{key:s,attrs:{name:s}},["img"===e.type?a("img",{staticClass:"post-img",attrs:{src:e.data.imageUrl}}):t._e(),"location"===e.type?a("div",{staticClass:"small-map-container"},[a("GoogleMap",{attrs:{mapConfig:{center:e.data.coordinates[0],zoom:14},defaultMarker:{position:e.data.coordinates[0]},noInteraction:!0}})],1):t._e(),a("span",[t._v(t._s(e.data.description))])])})),1)],1)],1),a("div",{staticClass:"mt-10"},[a("q-btn",{staticClass:"mr-10",attrs:{color:"secondary",type:"submit",loading:t.loading}},[t._v("\n      Publicar\n    ")]),t._t("default")],2),a("q-dialog",{model:{value:t.showing.map,callback:function(e){t.$set(t.showing,"map",e)},expression:"showing.map"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v("Adicionar localização")])]),a("q-card-section",{staticClass:"q-pt-none"},[a("div",{staticClass:"map-container"},[a("GoogleMap",{attrs:{mapConfig:t.addLocationMapConfig},on:{clicked:t.handleMapClick}})],1),a("q-input",{attrs:{label:"Descrição"},model:{value:t.currentLocation.description,callback:function(e){t.$set(t.currentLocation,"description",e)},expression:"currentLocation.description"}})],1),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:"Adicionar"},on:{click:t.addLocation}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Fechar"}})],1)],1)],1),a("q-dialog",{model:{value:t.showing.imageAttach,callback:function(e){t.$set(t.showing,"imageAttach",e)},expression:"showing.imageAttach"}},[a("q-card",[a("q-card-section",[a("div",{staticClass:"text-h6"},[t._v("Adicionar imagem")])]),a("q-card-section",{staticClass:"q-pt-none"},[a("input",{ref:"contentImageInput",attrs:{type:"file"}}),a("q-input",{attrs:{label:"Descrição"},model:{value:t.currentImage.description,callback:function(e){t.$set(t.currentImage,"description",e)},expression:"currentImage.description"}})],1),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:"Adicionar"},on:{click:t.addImage}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Fechar"}})],1)],1)],1)],1)},j=[],N=(a("2b3d"),a("ddb0"),a("7424")),P=a("d004");const z={all:async(t={})=>N["a"].get("posts",{params:t}).then((t=>({success:!0,posts:t.data.posts}))).catch((t=>Object(P["a"])({er:t,defaultMessage:"Não foi possível listar as publicações"}))),store:async t=>N["a"].post("posts",t).then((t=>({success:!0,message:t.data.message,post:t.data.post}))).catch((t=>Object(P["a"])({er:t,defaultMessage:"Não foi possível registrar a publicação"}))),addLocation:async(t,e)=>N["a"].post(`posts/locations/${t}/create`,e).then((t=>({success:!0,message:t.data.message,post:t.data.post}))).catch((t=>Object(P["a"])({er:t,defaultMessage:"Não foi possível registrar a publicação"}))),addAttachment:async(t,e)=>N["a"].post(`posts/attachments/${t}/create`,e).then((t=>({success:!0,message:t.data.message,post:t.data.post}))).catch((t=>Object(P["a"])({er:t,defaultMessage:"Não foi possível registrar a publicação"})))};var D=z,S={name:"ContentForm",components:{GoogleMap:I},props:{classId:{required:!1,type:Number}},data:()=>({loading:!1,content:{title:"",subtitle:"",body:""},attachments:[],locations:[],currentLocation:{position:null,description:""},currentImage:{file:null,imageUrl:"",description:""},carouselLocationIndex:0,showing:{map:!1,imageAttach:!1},addLocationMapConfig:{center:{lat:-9.38552,lng:-40.499776},zoom:14},images:[],resources:[]}),mounted(){this.getCurrentPosition()},methods:{async submit(){this.loading=!0;const t=await D.store({...this.content,class_id:this.classId});if(!t.success)return this.loading=!1,this.$emit("error",t);this.resources.length&&this.resources.forEach((async(e,a)=>{if("location"===e.type)await D.addLocation(t.post.id,{index:a,...e.data});else{const s=new FormData;s.append("index",a),s.append("file",e.data.file),s.append("type",e.type),s.append("description",e.data.description),await D.addAttachment(t.post.id,s)}})),this.loading=!1,this.$emit("success",{content:{...this.content,locations:this.locations}})},toggleImageAttach(){this.showing.imageAttach=!this.showing.imageAttach},addImage(){if(!this.$refs.contentImageInput.files.length)return!1;const t=this.$refs.contentImageInput.files[0],e={file:t,imageUrl:URL.createObjectURL(t),description:this.currentImage.description};this.images.push(e),this.resources.push({type:"img",data:e}),this.toggleImageAttach()},getCurrentPosition(){window.navigator.geolocation.getCurrentPosition((({coords:{latitude:t,longitude:e}})=>{this.addLocationMapConfig={center:{lat:t,lng:e},zoom:14}}))},addLocation(){const t={type:"point",...this.currentLocation,coordinates:[{lat:this.currentLocation.coordinates.lat(),lng:this.currentLocation.coordinates.lng()}]};this.locations.push(t),this.currentLocation.description="",this.resources.push({type:"location",data:t}),this.toggleMap()},toggleMap(){this.showing.map=!this.showing.map},handleMapClick({latLng:t}){this.currentLocation.coordinates=t},prevCarouselLocation(){0!==this.carouselLocationIndex?this.carouselLocationIndex--:this.carouselLocationIndex=this.locations.length-1},nextCarouselLocation(){this.carouselLocationIndex!==this.locations.length-1?this.carouselLocationIndex++:this.carouselLocationIndex=0},deleteLocation(){confirm("Deseja realmente excluir essa localização?")&&(this.locations=this.locations.filter(((t,e)=>e!==this.carouselLocationIndex)))}}},E=S,G=(a("2b64"),a("0378")),B=a("27f9"),U=a("f20b"),F=a("1c1c"),T=a("66e5"),K=a("4074"),H=a("cb32"),J=a("0170"),W=a("24e8"),V=a("7f67"),Y=Object(u["a"])(E,$,j,!1,null,"5c55a3e9",null),X=Y.exports;h()(Y,"components",{QForm:G["a"],QInput:B["a"],QBtnDropdown:U["a"],QList:F["a"],QItem:T["a"],QItemSection:K["a"],QAvatar:H["a"],QItemLabel:J["a"],QCard:_["a"],QCardSection:k["a"],QCarousel:w["a"],QCarouselSlide:R["a"],QBtn:p["a"],QDialog:W["a"],QCardActions:A["a"]}),h()(Y,"directives",{ClosePopup:V["a"]});var Z={name:"PostsContainer",components:{Post:O,ContentForm:X},props:{tags:{type:Array,required:!1,default:()=>[]},classId:{type:Number,required:!1,default:()=>null},inputLabel:{type:String,required:!1,default:()=>"Compartilhe algo com a comunidade"}},data:()=>({publishing:!1,lorem:"Lorem ipsum dolor sit, amet consectetur adipisicing elit. Voluptates totam asperiores, illo assumenda nulla deleniti praesentium earum excepturi veritatis",posts:[],loading:!1,page:1,perPage:10}),computed:{readyPosts(){return this.posts}},mounted(){this.loadPosts()},methods:{onReact(t,e){this.posts=this.posts.map((a=>(a.id===t.id&&(a.reactedWith=e),a)))},async loadPosts(){this.loading=!0;const t=await D.all({page:this.page,per_page:this.perPage,class_id:this.classId});if(this.loading=!1,!t.success)return!1;this.posts=t.posts},onContentAdded(){this.loadPosts()}}},tt=Z,et=Object(u["a"])(tt,s,o,!1,null,null,null);e["a"]=et.exports;h()(et,"components",{QInput:B["a"],QCard:_["a"],QCardSection:k["a"],QBtn:p["a"]})},"605e":function(t,e,a){"use strict";var s=a("7424"),o=a("d004");const n={all:async()=>s["a"].get("classes").then((t=>({success:!0,message:t.data.message,classes:t.data.classes}))).catch((t=>Object(o["a"])({er:t,defaultMessage:"Não foi possível listar as turmas"}))),find:async t=>s["a"].get(`classes/${t}`).then((t=>({success:!0,message:t.data.message,class:t.data.class}))).catch((t=>Object(o["a"])({er:t,defaultMessage:"Não foi possível encontrar a turma"})))};e["a"]=n},7424:function(t,e,a){"use strict";var s=a("bc3a"),o=a.n(s),n=a("4360");console.log("TOKEN","http://localhost:3333");const i=o.a.create({baseURL:"http://localhost:3333"});i.interceptors.request.use((t=>{const e=n["a"].state.user.data;return e&&(t.headers["Authorization"]=e.token),t})),e["a"]=i},"95fe":function(t,e,a){"use strict";a("a581")},9780:function(t,e,a){"use strict";var s=a("bc3a"),o=a.n(s);a("4360");const n=o.a.create({baseURL:"http://localhost:3333"});console.log("API CHAT","http://localhost:3333"),e["a"]=n},a0ac:function(t,e,a){"use strict";a("3b25")},a4d6:function(t,e,a){"use strict";var s=a("9780"),o=a("d004");const n={all:async t=>s["a"].get("messages",{params:{conversationId:t}}).then((t=>({success:!0,messages:t.data.messages}))).catch((t=>Object(o["a"])({er:t,defaultMessage:"Não foi possível listar as mensagens"}))),getConverses:async t=>s["a"].get("converses",{params:t}).then((t=>({success:!0,converses:t.data.converses}))).catch((t=>Object(o["a"])({er:t,defaultMessage:"Não foi possível listar as conversas"}))),find:async t=>s["a"].get(`converses/${t}`).then((t=>({success:!0,messages:t.data.converse.messages,converse:t.data.converse}))).catch((t=>Object(o["a"])({er:t,defaultMessage:"Não foi possível obter detalhes da conversa"}))),createConverse:async t=>s["a"].post("converses",{...t}).then((t=>({success:!0,message:t.data.message,converse:t.data}))).catch((t=>Object(o["a"])({er:t,defaultMessage:"Não foi possível realizar o cadastro "})))};e["a"]=n},a581:function(t,e,a){},ac8b:function(t,e,a){},ae6f:function(t,e,a){},c333:function(t,e,a){"use strict";(function(t){var s=a("f464"),o=a.n(s);e["a"]={name:"GoogleMap",props:{mapConfig:{type:Object,default:()=>({center:{lat:-9.38552,lng:-40.499776},zoom:4})},defaultMarker:{type:Object,required:!1,default:()=>null},noInteraction:{type:Boolean,required:!1,default:()=>!1}},data:()=>({google:null,map:null,marker:null}),async mounted(){const e=await o()({apiKey:t.env.GOOGLE_API_KEY});this.google=e,this.initializeMap()},methods:{initializeMap(){const t=this.$refs.googleMap;this.map=new this.google.maps.Map(t,this.mapConfig),this.addMapListeners(),this.addDefaultMarker()},addMapListeners(){if(this.noInteraction)return!1;this.map.addListener("click",(({latLng:t})=>{this.marker&&this.marker.setMap(null),this.marker=new this.google.maps.Marker({position:t,map:this.map}),this.$emit("clicked",{latLng:t})}))},addDefaultMarker(){this.defaultMarker&&new this.google.maps.Marker({position:this.defaultMarker.position,map:this.map})}}}}).call(this,a("4362"))},d004:function(t,e,a){"use strict";e["a"]=function({er:t,defaultMessage:e}){const a={success:!1,message:e};return t.response&&t.response.data&&(a.message=t.response.data.message||e),a}},d1dd:function(t,e,a){"use strict";var s=a("7424"),o=a("d004");const n={login:async(t,e)=>s["a"].post("login",{email:t,password:e}).then((t=>({success:!0,message:t.data.message,user:t.data.user}))).catch((t=>Object(o["a"])({er:t,defaultMessage:"Não foi possível realizar login"}))),register:async t=>s["a"].post("register",{...t}).then((t=>({success:!0,message:t.data.message,user:t.data.user}))).catch((t=>Object(o["a"])({er:t,defaultMessage:"Não foi possível realizar o cadastro "})))};e["a"]=n},d3c5:function(t,e,a){"use strict";a("ac8b")}}]);